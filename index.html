<!-- www/index.html -->
<!doctype html>
<html>
<head>
    <meta charset="utf-8"/>
    <title>University Admission — Web UI</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .btn { padding: 8px 12px; margin: 4px; cursor: pointer; }
        .panel { border: 1px solid #ddd; padding: 12px; margin-bottom: 12px; border-radius: 6px; }
        pre { background:#f6f6f6; padding:10px; overflow:auto; }
    </style>
</head>
<body>
<h2>University Admission — Web UI</h2>

<div class="panel">
    <button class="btn" id="btn-sample">Create sample universities</button>
    <button class="btn" id="btn-list-univs">Show universities</button>
    <button class="btn" id="btn-process">Process applications</button>
    <button class="btn" id="btn-list-apps">List applicants</button>
    <button class="btn" id="btn-export">Export CSV</button>
</div>

<div class="panel">
    <h4>Add applicant</h4>
    <label>Name: <input id="a_name"></label><br/>
    <label>JEE Rank: <input id="a_rank" type="number"></label><br/>
    <label>12th %: <input id="a_perc" type="number"></label><br/>
    <label>Category: <input id="a_cat" value="General"></label><br/>
    <label>Preferences (comma): <input id="a_prefs" value="Computer Science"></label><br/>
    <button class="btn" id="btn-add">Add applicant</button>
</div>

<div class="panel">
    <h4>Output</h4>
    <pre id="out">No output yet.</pre>
</div>

<script>
    const out = document.getElementById('out');
    function show(o){ out.textContent = typeof o === 'string' ? o : JSON.stringify(o,null,2); }

    document.getElementById('btn-sample').onclick = async () => {
        const r = await fetch('/api/create_sample', {method:'POST'});
        show(await r.json());
    };
    document.getElementById('btn-list-univs').onclick = async () => {
        const r = await fetch('/api/universities');
        show(await r.json());
    };
    document.getElementById('btn-process').onclick = async () => {
        const r = await fetch('/api/process', {method:'POST'});
        show(await r.json());
    };
    document.getElementById('btn-list-apps').onclick = async () => {
        const r = await fetch('/api/list_applicants');
        show(await r.json());
    };
    document.getElementById('btn-export').onclick = async () => {
        const r = await fetch('/api/export/admissions.csv', {method:'POST'});
        show(await r.json());
    };

    document.getElementById('btn-add').onclick = async () => {
        const name = document.getElementById('a_name').value;
        const rank = parseInt(document.getElementById('a_rank').value || "5000");
        const perc = parseInt(document.getElementById('a_perc').value || "75");
        const category = document.getElementById('a_cat').value || "General";
        const prefs = (document.getElementById('a_prefs').value || "Computer Science").split(',').map(s=>s.trim()).filter(Boolean);

        const r = await fetch('/api/add_applicant', {
            method: 'POST',
            headers: {'Content-Type':'application/json'},
            body: JSON.stringify({
                name: name,
                jee_rank: rank,
                percentage_12th: perc,
                category: category,
                preferences: prefs
            })
        });
        show(await r.json());
    };
</script>
</body>
</html>
